<!DOCTYPE html>
<html lang="en">
<head>
    <title>SIRU - Reportes de Daños</title>

    <link rel="icon" type="image/x-icon" href="../static/images/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <a href="#Muchos" 
    class="sr-only sr-only-focusable">Saltar a la pagina principal</a>

    <link rel="stylesheet" 
    href="https://www.w3schools.com/w3css/4/w3.css">
    
    <link rel="stylesheet" 
    href="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.css">

    <link rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    
    
    <link rel="stylesheet"
    href="..\static\css\estilosAD.css">

    <script src="../static/js/JS_Admin/CargarRegistros.js"></script>
    <script src="../static/js/JS_Admin/ConfiDeRegistros.js"></script>
    <script src="../static/js/JS_Admin/ActualizarReporte.js"></script>
    <script src="../static/js/JS_Admin/CargarUsuarios.js"></script>
    <script src="../static/js/JS_Admin/ConfirmarDesacActivacion.js"></script>
    <script src="../static/js/JS_Admin/CancelarYGuardar.js"></script>
    <script src="../static/js/JS_Admin/EditarUsuario.js"></script>
    <script src="../static/js/JS_Admin/FiltrarRegistro.js"></script>
    <script src="../static/js/JS_Admin/CambiarEstado.js"></script>
    <script src="../static/js/JS_Admin/BuscarUsuario.js"></script>
    <script src="../static/js/JS_Admin/PreVisualizacion.js"></script>
    <script src="../static/js/JS_Admin/VisUsuarios.js"></script>
    <script src="../static/js/JS_Admin/MostrarOcultar.js"></script>
    <script src="../static/js/JS_Admin/LugaresCrearAñadirCopiar.js"></script>
    <script src="../static/js/JS_Admin/ItemCrearAñadirCopiar.js"></script>
    <script src="../static/js/JS_Admin/ItemEditarEliminar.js"></script>
    <script src="../static/js/JS_Admin/LugarEditarEliminar.js"></script>
    <script src="../static/js/JS_Admin/lugaritemvisualizar.js"></script>

    <script src="../static/js/JS_Genericos/EliminarRegistro.js"></script>
    <script src="../static/js/JS_Genericos/Restablecer.js"></script>
    <script src="../static/js/JS_Genericos/ImagenesDefecto.js"></script>
    <script src="../static/js/JS_Genericos/Dropdown.js"></script>
    <script src="../static/js/JS_Genericos/cerrarsesion.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", CargarRegistros); // Cargar registros al cargar la página
        </script>
       
        
        


</head>

<!--Encabezado-->
<body>
    <header class="w3-container w3-center w3-padding-32" 
    style="background-color: #C20E1A;"> 
        <h1><b>SIRU - Reportes de Daños</b></h1>
    </header>

<!-- Elementos de pagina -->
    <div class="w3-row">

        <!--Parte izquierda-->
        <div class="w3-container w3-col l4">
        <div class= "w3-container w3-white w3-card w3-border w3-margin-top">
                   <h4><b>Bienvenido -Admin-</b></h4>
                    <p>¿Que opcion quieres hacer?:</p>
                   
                    <button id="BotonDeOpciones"
                    class="w3-button w3-center w3-red w3-hover-opacity w3-section w3-block"
                   onclick="DropdownOpciones('opciones')"
                   title="Opciones">
                Opciones
            </button>
                   
                   <div 
                   id="opciones"
                   style="display: none;">

                    <button 
                    onclick="document.getElementById('Filtrar').style.display='block'" 
                    class="w3-button w3-center w3-red w3-hover-pink w3-section w3-block"
                    title="Filtrar registros">
                    Filtrar Registros</button>

                    <button 
                    onclick="AbrirModal()"
                    class="w3-button w3-red w3-hover-pink w3-section w3-block"
                    title="Administrar usuario">
                    Administrar usuarios</button>

                    <button 
                    onclick="" 
                    class="w3-button w3-red w3-hover-pink w3-section w3-block"
                    title="Notificaciones">
                    Notificaciones</button>

                    <button 
                    onclick="document.getElementById('LugarItem').style.display='block'"
                    class="w3-button w3-red w3-hover-pink w3-section w3-block"
                    title="Administracion de zonas">
                    Zonas e items</button>

                    <button 
                    onclick=""
                    class="w3-button w3-red w3-hover-pink w3-section w3-block"
                    title="Datos Estadisticos">
                    Datos Estadisticos</button>

                    <button 
                    onclick="CerrarSesion()" 
                    class="w3-button w3-red w3-hover-grey w3-section w3-block"
                    title="Cerrar sesion">
                    Cerrar sesion</button>
                </div>
            </div>
        </div>
        
        <!-- Zona  derecha -->
        <div class="w3-col l8 "
        id="Muchos">
            
            </div>
            <hr>
        </div>
    </div>


    <!-- Pie de pagina -->
    <footer class="w3-container w3-padding-32 w3-margin-top"
     style="background-color: #841F1C;">
        <p><b>Un buen trabajo para una buena revision </b> 
    </footer>

<!--Mostrar modales-->
<div class="w3-modal"
id="Modal"
style="display: none;">

<div class="w3-modal-content w3-animate-zoom w3-card-4">

</div>
</div>

<!--Administracion-->
<div class="w3-modal"
id="administrar">

<div class="w3-modal-content w3-card-4 w3-animate-zoom"
style="max-width:800px;
bottom: 10%;">

<header class="w3-container w3-center"
style="background-color: #C20E1A;">

<button 
onclick = "document.getElementById('administrar').style.display='none'"
class   = "w3-button w3-xlarge w3-hover-red w3-display-topright"
title   = "Cerrar pestaña"> &times; </button>

<h3><b>Administracion de usuarios</b></h3>

</button>
</header>

<div class="w3-container">

<div class="w3-row w3-padding-16">
<div class="w3-col m8">
    <input class="w3-input"
    type="text"
    id="BarraBuscar"
    placeholder="Buscar por nombre">
</div>

<div class="w3-col m4">
<button class="w3-button w3-red w3-block" 
onclick="BuscarUsuario()">
Buscar
</button>

</div>
</div>

<div class="w3-bar w3-light-grey">

<button class="w3-bar-item w3-button"
title="Admin"
onclick="CargarUsuarios('Admin');
Ensombrecer(this)">
Admin
</button>

<button class="w3-bar-item w3-button"
title="Usuario"
onclick="CargarUsuarios('Usuario');
Ensombrecer(this)">
Usuarios
</button>

<button class="w3-bar-item w3-button"
title="Todos"
id="TodosUsuarios"
onclick="CargarUsuarios('todos');
Ensombrecer(this)">
Todos
</button>
</div>

<div id="Tabla"
class="w3-container w3-padding-16">
</div>
</div>

<footer class="w3-container w3-light-grey">
<button class="w3-button w3-red w3-block w3-section"
title="Guardar cambios"
onclick="GuardarCambios()">
Guardar</button>

<button class="w3-block w3-button w3-red"
title="Cancelar"
onclick="cancelar()">
Cancelar</button>

</footer>
</div>
</div>

<!-- Filtro -->
<div class="w3-container w3-center">
    <div class="w3-modal" id="Filtrar">
        <div class="w3-modal-content w3-card-4 w3-white">
            <header class="w3-container w3-center"
            style="background-color: #C20E1A;">
                <h3><b>Filtrar reportes en específico</b></h3>
                <button onclick="document.getElementById('Filtrar').style.display='none'" 
                class="w3-button w3-xlarge w3-hover-red w3-display-topright" 
                title="Cerrar pestaña">&times;</button>
            </header>

            <form class="w3-container w3-padding-16" onsubmit="FiltrarRegistro(event)">
                <!-- Campos de filtro básicos -->
                <div class="w3-row-padding w3-margin-bottom">
                    <div class="w3-col s12">
                        <label for="NombreUsuario"><b>Buscar usuario</b>
                        </label>
                            <input id="NombreUsuaio" 
                        title="Buscar usuario"
                        class="w3-input w3-border" 
                        type="text" 
                        placeholder="Nombre de usuario a buscar reportes">
                    </div>
                </div>

                <div class="w3-row-padding w3-margin-bottom">
                    <div class="w3-half">
                        <label for="buscarLugar">
                            <b>Buscar por lugar</b></label>
                        <input id="buscarLugar" 
                        title="Por zona"
                        class="w3-input w3-border" 
                        type="text" 
                        placeholder="Lugar a buscar">
                    </div>

                    <div class="w3-half">
                        <label for="buscarItem">
                        <b>Buscar por item</b></label>
                        <input id="buscarItem" 
                        title="Buscar por item"
                        class="w3-input w3-border" 
                        type="text" 
                        placeholder="Item a buscar">
                    </div>
                </div>

                <!-- Elementos varios -->
                <h2 class="w3-center-all w3-black-text">Elementos varios</h2>

                <div class="w3-row-padding w3-margin-bottom">
                    <div class="w3-third">
                     <label for="Tiporeporte">
                        <b>Tipo del reporte</b></label>

                        <select id="Tiporeporte" 
                        class="w3-select w3-border">
                            <option value="" selected>---</option>
                            <option value="Sugerencia">Sugerencia</option>
                            <option value="Mantenimiento">Mantenimiento</option>
                            <option value="Reparacion">Reparacion</option>
                        </select>
                    </div>

                    <div class="w3-third">
                        <label for="ordenarRecienteAntiguo">
                        <b>Ordenar por antiguo o reciente</b></label>
                        <select id="ordenarRecienteAntiguo" class="w3-select w3-border">
                            <option value="" selected>---</option>
                            <option value="Antiguo">Más antiguo</option>
                            <option value="Reciente">Más reciente</option>
                        </select>
                    </div>

                    <div class="w3-third">
                        <label for="Estadoreporte">
                        <b>Estado del reporte</b></label>
                        <select id="Estadoreporte" 
                        class="w3-select w3-border">
                            <option value="" selected>---</option>
                            <option value="No verificado">No verificado</option>
                            <option value="En proceso">En proceso</option>
                            <option value="Terminado">Terminado</option>
                        </select>
                    </div>
                </div>

                <!-- Opciones avanzadas -->
                <h2 class="w3-center-all w3-black-text">Opciones avanzadas</h2>

                <div class="w3-section w3-center-all">
                    <div class="w3-container w3-border w3-margin-bottom w3-padding-small">
                        <div class="w3-row">
                            <div class="w3-col s9">
                                <p>Que no aparezcan los que ya fueron resueltos</p>
                            </div>
                            <div class="w3-col s3">
                                <label for="desactivado2"
                                class="w3-right">
                                    <input id="desactivado2" 
                                    class="w3-radio" 
                                    type="radio"
                                    title="Desactivado" 
                                     name="resueltos" 
                                     value="desactivado" 
                                     checked> 
                                     Desactivado
                                </label>
                                
                                <label for="activado2"
                                 class="w3-right w3-margin-right">
                                    <input id="activado2" 
                                    class="w3-radio"
                                     type="radio"
                                     title="Activado"  
                                     name="resueltos" 
                                     value="activado"> Activar
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="w3-container w3-border w3-margin-bottom w3-padding-small">
                        <div class="w3-row">
                            <div class="w3-col s9">
                                <p>Que no aparezcan los que no tienen imagen</p>
                            </div>
                            <div class="w3-col s3">

                                <label  for="desactivado3"
                                class="w3-right">
                                    <input id="desactivado3" 
                                    class="w3-radio" 
                                    type="radio" 
                                    name="sin_imagen" 
                                    value="desactivado" 
                                    title="Desactivado" 
                                    checked> 
                                    Desactivado
                                </label>

                                <label for="activado3"
                                 class="w3-right w3-margin-right">
                                    <input id="activado3" 
                                    class="w3-radio" 
                                    type="radio"
                                    title="Activado" 
                                     name="sin_imagen" 
                                     value="activado"> Activar</label>

                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botones de acción -->
                <button title="Buscar"
                class="w3-button w3-red w3-margin-top w3-block"
                type="submit">Buscar</button>

                <button title="Restablecer"
                class="w3-button w3-gray w3-margin-top w3-small w3-right" type="button" 
                onclick="RestablecerFiltro()">Restablecer</button>
            </form>
        </div>
    </div>
</div>

<!--Zonas e items-->
<div class="w3-container">

    <div class="w3-modal"
    id="LugarItem">

    <div class="w3-modal-content w3-card-4 w3-white">
        <header class="w3-container w3-center"
        style="background-color: #C20E1A;">
            <h3 id="NombreTitulo"><b>Administrador de lugares e items</b></h3>
            <button onclick="document.getElementById('LugarItem').style.display='none'" 
            class="w3-button w3-xlarge w3-hover-red w3-display-topright" 
            title="Cerrar pestaña">&times;</button>
        </header>

        <!--Menu principal de seleccion-->
        <div class="w3-container w3-padding-16 w3-center"
        id="SeleccionarMenu">
            <h2><b> Escoge el menú al que necesites ir: </b></h2>

            <button class="w3-button w3-red w3-margin-bottom"
                    onclick="IrALugar()">
                Menú de lugares
            </button>

            <button class="w3-button w3-red w3-margin-bottom"
                    onclick="IrAItem()">  
                    Menú de ítems
            </button>
        </div>

        <!--Menus de lugares-->
        <div id="MenuLugares"
        style="display: none;">

        <!--Opciones menu lugares-->
        <div class="w3-bar w3-border w3-light-grey w3-bar">

            <button class="w3-bar-item w3-button"
            id="VisualizarL"
            onclick="IrVisualizarLugar();
            Ensombrecer(this)">
                Visualizar
             </button>

             <button class="w3-bar-item w3-button"
             onclick="IrCrearLugar();
            Ensombrecer(this)">
                Crear y añadir
             </button>

             <button class="w3-bar-item w3-button"
             onclick="IrEditarLugar();
            Ensombrecer(this)">
                Editar
             </button>

             <button class="w3-bar-item w3-padding w3-button"
            onclick="Volver()">
               Salir
            </button>
        </div>

        <!--Visualizar lugares con sus items-->
        <div class="w3-container w3-center"
        style="padding: 20px;"
        id="VisualizarLugar">

        <h4><b> Escoge la clase de item que quieras para que se visualize </b></h4>

                    <select id="VLVisualizarLugar" 
                    class="w3-select w3-light-grey"
                    style = "width: 125px;
                    margin: 20px auto;"
                    onchange="cargarItemsPorLugar_yclase()">
                        <option value="" disabled selected>Lugar a buscar</option>
                        <option value="todos">Todos los lugares</option>
                       
                    </select>

                    <select id="VLClaseItemVisualizar" 
                    class="w3-select w3-light-grey"
                    style = "width: 155px;"
                    onchange="cargarItemsPorLugar_yclase()">
                        <option value="" disabled selected>Clase de item a ver</option>
                        <option value="todos">Todos</option>
                        <option value="generales">Generales</option>
                        <option value="electricos">Electricos</option>
                        <option value="baños">Accesorios de baños</option>
                        <option value="salones">Salones</option>
                        <option value="informaticos">Informaticos</option>
                        <option value="patio">Elementos del patio</option>
                    </select>

                    <textarea class=" w3-input w3-border w3-light-grey"
                    style="width: 300px;
                    height: 190px;
                    margin: auto;"
                    id="VLItemsVisualizados"
                    placeholder="Los items apareceran aquí"
                    readonly>
                    </textarea>
        </div>

         <!--Crear lugares con sus items-->
         <div class="w3-container w3-padding-16"
         style="display: none;"
         id="CrearLugar">

         <div class="w3-third w3-center">
            <small>Zona de creación de lugares</small>
            
            <br>
            <p style="margin-top: 20px;">
                <b> Crear lugar:</b></p>

            <input class="w3-input w3-border w3-block w3-light-grey"
            type="text"
            id="VLCrearLugar"
            style="width: 80%;
            margin: auto;"
            placeholder="Nombre del nuevo lugar">

            <button class="w3-button w3-margin-top w3-red w3-margin-bottom"
            id="VLBotonCrearLugar"
            onclick="CrearLugar()">
                Crear lugar
            </button>
         </div>

         <div class="w3-third w3-center">
            <small> Añadir items a los lugares</small>

            <br>
            <p style="margin-top: 10px;">
                <b> Lugares disponibles:</b></p>

            <select id="VLlugarSinItems"
            class="w3-select w3-margin-bottom w3-light-grey"
            style="width: 80%;">
                <option value="" disabled selected>Seleccionar lugar</option>
            </select>

            <p><b>Items disponibles: 

            </b></p>
            <select id="VLItemAñadir"
            class="w3-select w3-margin-bottom w3-light-grey"
            style="width: 80%;">
                <option value="" disabled selected>Seleccionar item</option>
                
            </select>

            <button class="w3-button w3-red w3-margin-bottom"
            onclick="agregarItemALugar()"
            id="VLBotonAñadirItem">
                Añadir item
            </button>
         </div>
         
        <div class="w3-third w3-center">
            <small>Copiar items de otros lugares</small>
            <br>
            <p style="margin-top: 10px;">
                <b> Lugares disponibles:</b></p>

            <select class="w3-select w3-margin-bottom w3-light-grey"
            id="VLLugarCopiaraitems"
            style="width: 80%;">
                <option value="" disabled selected>Seleccionar lugar</option>
            </select>

            <p><b>Lugar con elementos a copiar:</b></p>
            <select class="w3-select w3-margin-bottom w3-light-grey"
            id="VLlugarAcopiar"
            style="width: 80%;">
                <option value="" disabled selected>Seleccionar item</option>
            </select>

            <button class="w3-button w3-red w3-margin-bottom"
            onclick="copiarItemsDeLugar() "
            id="VLCopiarElementos">
                Copiar elementos
            </button>

        </div>
        </div>

          <!--Editar lugares con sus items-->
          <div class="w3-container w3-padding-16 w3-center"
          style="display: none;"
          id="EditarLugar">


         <div class="w3-half w3-center">
            <small> Eliminar item de algun lugar</small>

            <br>
            <p style="margin-top: 10px;"><b> 
                Lugar con el item:</b></p>

            <select class="w3-select w3-margin-bottom w3-light-grey"
            style="width: 80%;"
            id="VLlugarConElItem">
                <option value="" disabled selected>Seleccionar lugar</option>
            </select>

            <p><b>Item a eliminar: </b></p>
            <select class="w3-select w3-margin-bottom w3-light-grey"
            id="VLitemAEliminar"
            style="width: 80%;">
                <option value="" disabled selected>Seleccionar item</option>
            </select>

            <button class="w3-button w3-red w3-margin-bottom"
            id="VLeliminarItemDelLugar"
            onclick="eliminarelitem()">
                Eliminar item
            </button>
         </div>
         
        <div class="w3-half w3-center">
            <small>Zona para eliminar lugares</small>
            <br>
            <p style="margin-top: 20px;"><b> 
                Lugar a eliminar:</b></p>
            <select id="VLlugarAeliminar" 
            class="w3-select w3-margin-bottom w3-light-grey"
            style="width: 80%;">
                <option value="" disabled selected>Seleccionar lugar</option>
            </select>

            <button class="w3-button w3-red w3-margin-bottom"
            onclick="eliminarlugarcompleto()">
                Eliminar lugar
            </button>
        </div>    
          </div>
         </div>

        <!--Menus de items-->
        <div id="MenuItems"
        style="display: none;">

        <!--Opciones de item-->
        <div class="w3-bar w3-light-grey w3-block"> 

            <button class="w3-bar-item w3-button"
            id="VisualizarI"
            onclick="IrVisualizarItem()
            Ensombrecer(this)">
                Visualizar
             </button>

             <button class="w3-bar-item w3-button"
             onclick="IrCrearItem()
             Ensombrecer(this)">
                Crear y añadir
             </button>

             <button class="w3-bar-item w3-button"
             onclick="IrEditarItem()
             Ensombrecer(this)">
                Eliminar
             </button>

             <button class="w3-bar-item w3-button"
             onclick="Volver()">
              Salir
             </button>
        </div>

        <!--Visualizar items con su clase-->
        <div class="w3-container w3-center"
        style="padding: 20px;"
        id="VisualizarItems">

        <h4><b> Escoge el lugar para visualizar todos sus items correspondientes tambien escogiendo la clase items que se desea </b></h4>


                    <select id="VIclaseDeItem" 
                    class="w3-select w3-light-grey"
                    style = "width: 205px;
                    margin: 20px;"
                    onchange="cargarItems()">
                        <option value="" disabled selected>Clase de item a ver</option>
                        <option value="todos">Todos</option>
                        <option value="sinclase">Sin clase</option>
                        <option value="generales">Generales</option>
                        <option value="electricos">Electricos</option>
                        <option value="baños">Accesorios de baños</option>
                        <option value="salones">Salones</option>
                        <option value="informaticos">Informaticos</option>
                    </select>

                    <textarea class=" w3-input w3-border w3-light-grey"
                    style="width: 250px;
                    height: 190px;
                    margin: auto;"
                    id="VIvisualizaritem"
                    placeholder="Los items apareceran aquí"
                    readonly>
                    </textarea>
        </div>
                
         <!--Crear Items y añadir clase-->
         <div class="w3-container w3-padding-16 w3-center"
         style="display: none;"
         id="CrearItems">

         
         <div class="w3-col l3 w3-center">
            <small>Zona de creación de items</small>
            
            <br>
            <p style="margin-top: 20px;"><b> 
                Crear item:</b></p>

            <input class="w3-input w3-border w3-block w3-light-grey"
            type="text"
            id="VIcreacionItem"
            style="width: 80%;
            margin: auto;"
            placeholder="Nombre del nuevo item">

            <button class="w3-button w3-margin-top w3-red w3-margin-bottom"
            id="VIbotonCrearItem"
            onclick="CrearItem()">
                Crear item
            </button>
         </div>
        
         <!--Zona de opciones-->
         <div class="w3-col l9">

            <small>Zona para añadir la de los items</small>
            <br>

                 <div class="zona"
                 id="sinclase"
                 ondrop="drop(event)"
                 ondragover="mover(event)"> 
         <h4>Sin clase</h4>
                </div>

         <div class="zona"
         id="generales"
         ondrop="drop(event)"
         ondragover="mover(event)"> 
        <h4>Generales</h4>
 </div>

 <div class="zona"
 id="electricos"
 ondrop="drop(event)"
 ondragover="mover(event)"> 
<h4>Electricos</h4>
</div>

<div class="zona"
id="baños"
ondrop="drop(event)"
ondragover="mover(event)"> 
<h4>Baños</h4>
</div>

<div class="zona"
id="salones"
ondrop="drop(event)"
ondragover="mover(event)"> 
<h4>Salones</h4>
</div>

<div class="zona"
id="informaticos"
ondrop="drop(event)"
ondragover="mover(event)"> 
<h4>Informaticos</h4>
</div>

<button class="w3-button w3-margin-top w3-border w3-red w3-margin-bottom"
            id="VIguardarClaseItem"
            onclick="actualizarClase()">
                Guardar clases
            </button>

            <button class="w3-button w3-border w3-margin-top w3-margin-bottom"
            id="VICancelarCambios"
            onclick="cancelarCambios()">
                Cancelar cambios
            </button>

</div>
</div>

          <!--Eliminar items-->
          <div class="w3-container w3-padding-16 w3-center"
          style="display: none;"
          id="EditarItems">
            <small>Zona para eliminar items</small>
            <br>
            <p style="margin-top: 20px;"><b>
                 Item a eliminar:</b></p>
            <select class="w3-select w3-margin-bottom w3-light-grey"
            id="VIitemAeliminar"
            style="width: 50%;">
                <option value="" disabled selected>Seleccionar item</option>
            </select><br>

            <button class="w3-button w3-red w3-margin-bottom"
            onclick="eliminaritemcompleto()">
                Eliminar item
            </button>  
          </div>
    </div>
    </div>
    </div>
</div>

</body>
</html>
